@{
    ViewBag.Title = "Linq";
}

<h2>Language Integrated Query (LINQ)</h2>
<div id="metadata" cmpgrp="page info">
    <a href="https://github.com/guntidheerajkumar" class="avatar" title="Dheeraj Kumar Gunti">
        <span class="author-name" style="background-image: url('../../Images/avatar.png')" alt="Author Name"></span>
    </a>
    <div class="info">
        <span class="name"><a href="https://github.com/guntidheerajkumar">Dheeraj Kumar Gunti</a></span>
        <div class="meta">
            <p>Reading Time : <span class="eta"></span> (<span class="words"></span> words)</p>
        </div>
    </div>
</div>
<article>
    <p>
        LINQ (Language Integrated Query) is a uniform programming model for any kind of data. LINQ enables you to query and manipulate data with a consistent model that is independent from data sources. LINQ is the methodology that simplifies and unifies the implementation of any kind of data access. LINQ does not force you to use a specific architecture; it facilitates the implementation of several existing architectures for accessing data.
        <br />
        <br />
        Following is the example for how to create an application by using LINQ.
        <br />
        <br />
        Create an empty ASP.NET application and create a database named Person through SQL Express or else connect with SQL server studio edition. Create a table named tblPerson with the following fields.
        <br />
    </p>
    <br />
    <img src="~/Images/LINQ/Linq_2.jpg" class="img-responsive" />
    <br />
    <br />
    <p>Once the schema is done. Right click on the solution and select add new item and choose LINQ to SQL Classes template as below.</p>
    <br />
    <img src="~/Images/LINQ/Linq_1.jpg" class="img-responsive" />
    <br />
    <p>Once the .dbml file is added to your application then Object Relational Designer will open so that we can attach the database schema to the LINQ designer. Drag and drop the table from the database explorer to Object Relational Designer.</p>
    <br />
    <img src="~/Images/LINQ/Linq_3.jpg" class="img-responsive" />
    <br />
    <p>
        We will now move on to how to interact the database with the help LINQ programming.
        Following is the LINQ query which returns all the person details
    </p>
<pre>
PersonLinqDataContext dbContext <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PersonLinqDataContext<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>var</span> PersonData <span style='color:#808030; '>=</span> from c <span style='color:#800000; font-weight:bold; '>in</span> dbContext<span style='color:#808030; '>.</span>TblPersons
                    select c<span style='color:#800080; '>;</span>
</pre>
    <p>Following is the LINQ query which inserts data in to database.</p>
<pre>
<span style='color:#696969; '>// Creating the object for PersonLinqDataContext</span>
            PersonLinqDataContext dbContext <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PersonLinqDataContext<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// Creating the object for TblPerson Class         </span>
            TblPerson person <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> TblPerson<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// Assigning values to the propeties under the TblPerson Class</span>
            person<span style='color:#808030; '>.</span>NAME <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>Testing Name</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span> <span style='color:#696969; '>// Name Field</span>
            person<span style='color:#808030; '>.</span>AGE <span style='color:#808030; '>=</span> <span style='color:#008c00; '>28</span><span style='color:#800080; '>;</span> <span style='color:#696969; '>// Age Field</span>
            person<span style='color:#808030; '>.</span>ADDRESS <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>Testing Addres</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span> <span style='color:#696969; '>// Address Field</span>
            person<span style='color:#808030; '>.</span>PHONENUM <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>23456778</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span> <span style='color:#696969; '>// Phone Num field</span>
<span style='color:#696969; '>// Adds an entity in a pending insert state to this Table</span>
            dbContext<span style='color:#808030; '>.</span>TblPersons<span style='color:#808030; '>.</span>InsertOnSubmit<span style='color:#808030; '>(</span>person<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// Computes the set of modified objects to be inserted, updated, </span>
<span style='color:#696969; '>// or deleted, and executes the appropriate commands</span>
<span style='color:#696969; '>// to implement the changes to the database.</span>
            dbContext<span style='color:#808030; '>.</span>SubmitChanges<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>
    <p>Following is the LINQ Query which updates data in to database.</p>
<pre>
<span style='color:#696969; '>// Creating the object for PersonLinqDataContext</span>
        PersonLinqDataContext dbContext <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PersonLinqDataContext<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// fetching the data from tblpersons based on ID</span>
<span style='color:#800000; font-weight:bold; '>var</span> PersonData <span style='color:#808030; '>=</span> from c <span style='color:#800000; font-weight:bold; '>in</span> dbContext<span style='color:#808030; '>.</span>TblPersons
                         where c<span style='color:#808030; '>.</span>ID <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>1</span>
                         select c<span style='color:#800080; '>;</span>
<span style='color:#696969; '>// Assigning the changed values </span>
<span style='color:#800000; font-weight:bold; '>foreach</span> <span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>var</span> item <span style='color:#800000; font-weight:bold; '>in</span> PersonData<span style='color:#808030; '>)</span>
<span style='color:#800080; '>{</span>
            item<span style='color:#808030; '>.</span>NAME <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>Testing Name 123</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>
            item<span style='color:#808030; '>.</span>ADDRESS <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>Testing Address India</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>
            item<span style='color:#808030; '>.</span>PHONENUM <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>5495792348</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
<span style='color:#696969; '>// As we assigned modified values to the Tblperson </span>
<span style='color:#696969; '>// we are submitting the changes.</span>
        dbContext<span style='color:#808030; '>.</span>SubmitChanges<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>
    <p>Based on the update process wrote above the details in the database are modified as below.</p>
    <br />
    <img src="~/Images/LINQ/Linq_4.jpg" class="img-responsive" />
    <br /><br />
    <p>Following is the LINQ query which deletes the data from the database based on ID</p>
<pre>
<span style='color:#696969; '>// Creating the object for PersonLinqDataContext</span>
        PersonLinqDataContext dbContext <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PersonLinqDataContext<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// fetching the data from tblpersons based on ID</span>
<span style='color:#800000; font-weight:bold; '>var</span> PersonData <span style='color:#808030; '>=</span> <span style='color:#808030; '>(</span>from c <span style='color:#800000; font-weight:bold; '>in</span> dbContext<span style='color:#808030; '>.</span>TblPersons
                          where c<span style='color:#808030; '>.</span>ID <span style='color:#808030; '>=</span><span style='color:#808030; '>=</span> <span style='color:#008c00; '>2</span>
                          select c<span style='color:#808030; '>)</span><span style='color:#808030; '>.</span>FirstOrDefault<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// FirstorDefault - Returns the first element of a sequence, </span>
<span style='color:#696969; '>// or a default value if the sequence contains no elements.</span>
        
<span style='color:#696969; '>// we are calling Delete on Submit method which deletes the </span>
<span style='color:#696969; '>// value from tblPerson table.</span>
        dbContext<span style='color:#808030; '>.</span>TblPersons<span style='color:#808030; '>.</span>DeleteOnSubmit<span style='color:#808030; '>(</span>PersonData<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#696969; '>// we are submitting the changes.</span>
        dbContext<span style='color:#808030; '>.</span>SubmitChanges<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>
    <p>The above is the simple example of how we use LINQ for CRUD operations.</p>
</article>