@{
    ViewBag.Title = "ASP.NET Routing";
}

<h1>ASP.NET Routing</h1>
<p>
    ASP.NET routing enables you to use URLs that do not have to map to specific files in a Web site. Because the URL does not have to map to a file, you can use URLs that are descriptive of the user's action and therefore are more easily understood by users.
    <br />
    <br />
    Routing is fundamentally about decomposing a URL endpoint into parameters and then using those parameters to steer the HTTP request processing to a specific component. Let's take the URL /recipe/5 as an example. With the proper routing configuration, you can still respond to this URL with the Web Form RecipeDisplay.aspx.
    <br />
    <br />

    A route is a URL pattern that is mapped to a handler. The handler can be a physical file, such as an .aspx file in a Web Forms application. A handler can also be a class that processes the request, such as a controller in an MVC application. To define a route, you create an instance of the Route class by specifying the URL pattern, the handler, and optionally a name for the route.
    <br />
    <br />

    The URL no longer represents a physical path. Instead, the word recipe represents a parameter that the routing engine can use to locate a component for processing recipe requests. The number 5 represents a second parameter that you'll need during processing to display a specific recipe. Instead of encoding database keys into the URL, a better idea might be to use a URL like /recipe/tacos.
    <br />

</p>
<br />
<img src="~/Images/routing_1.gif" class="img-responsive" />
<br /><br />

<p>
    In an ASP.NET application that does not use routing, an incoming request for a URL typically maps to a physical file that handles the request, such as an .aspx file. For example, a request for http://server/application/Products.aspx?id=4 maps to a file that is named Products.aspx that contains code and markup for rendering a response to the browser. The Web page uses the query string value of id=4 to determine what type of content to display. System.Web.Routing namespace represents a route during run time and describes the route's parameters and constraints. A route handler inherits from the System.Web.Routing.IRouteHandler interface. This interface requires the route handler to implement a GetHttpHandler method that returns an object implementing the IHttpHandler interface. The IHttpHandler interface has been a part of ASP.NET since the beginning, and a Web Form (a System.Web.UI.Page) is an IHttpHandler. When using routing with Web Forms, your route handlers need to locate, instantiate, and return the proper Web Form. Finally, the routing module plugs into the ASP.NET processing pipeline. The module will intercept incoming requests, examine the URL, and discover if there are any matching routes defined. The module will retrieve the associated route handler for a matching route and ask the routing handler for the IHttpHandler that will process the request.
    <br />
    <br />
    <b>Configuring Routing:</b>
    <br />

    To configure an ASP.NET Web site or Web application for routing, you first need to add a reference to the System.Web.Routing assembly. You'll also need to configure the routing module into the ASP.NET pipeline. The routing module is a standard HTTP module. For IIS 6.0 and earlier and for the Visual Studio Web development server, you install the module using the section of web.config.
    <br />
</p>
<img src="~/Images/routing_2.png" class="img-responsive" />
<br />
<br />
<p>
    <b>Configuring Routes:</b><br />
    Routes and route handlers go hand in hand, but I'll look at the code to configure routes first. The routing engine's RouteTable class exposes a RouteCollection via its static Routes property. You need to configure all of your custom routes into this collection before the application begins to execute the first request, which means you need to use a global.asax file and the Application_Start event.
    <br />
</p>

<pre>
<span style='color:#800000; font-weight:bold; '>private</span> <span style='color:#800000; font-weight:bold; '>static</span> <span style='color:#800000; font-weight:bold; '>void</span> RegisterRoutes<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
<span style='color:#800080; '>{</span>
    RouteTable<span style='color:#808030; '>.</span>Routes<span style='color:#808030; '>.</span>Add<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Default</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>new</span> Route<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Default/{mode}/{name}</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>new</span> RecipeRouteHandler<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>~/Default.aspx</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
<span style='color:#800080; '>}</span>
</pre>
<p>
    - Creating custom route handler which is implemented from IRouteHandler interface.<br />
    - GetHttphandler is the method which is used to process the request which intern returns a object.
    <br />
</p>
<pre>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Web<span style='color:#808030; '>.</span>Routing<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Web<span style='color:#808030; '>.</span>Compilation<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Web<span style='color:#808030; '>.</span>UI<span style='color:#800080; '>;</span>
<br />
<span style='color:#800000; font-weight:bold; '>public</span> <span style='color:#800000; font-weight:bold; '>class</span> RecipeRouteHandler <span style='color:#808030; '>:</span> IRouteHandler
<span style='color:#800080; '>{</span>
    <span style='color:#800000; font-weight:bold; '>public</span> RecipeRouteHandler<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>string</span> virtualPath<span style='color:#808030; '>)</span>
    <span style='color:#800080; '>{</span>
        _virtualPath <span style='color:#808030; '>=</span> virtualPath<span style='color:#800080; '>;</span>
    <span style='color:#800080; '>}</span>
    <span style='color:#800000; font-weight:bold; '>public</span> IHttpHandler GetHttpHandler<span style='color:#808030; '>(</span>RequestContext requestContext<span style='color:#808030; '>)</span>
    <span style='color:#800080; '>{</span>
        <span style='color:#800000; font-weight:bold; '>var</span> display <span style='color:#808030; '>=</span> BuildManager<span style='color:#808030; '>.</span>CreateInstanceFromVirtualPath<span style='color:#808030; '>(</span>_virtualPath<span style='color:#808030; '>,</span>
        <span style='color:#800000; font-weight:bold; '>typeof</span><span style='color:#808030; '>(</span>Page<span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>as</span> IExample<span style='color:#800080; '>;</span>
        display<span style='color:#808030; '>.</span>Name <span style='color:#808030; '>=</span> requestContext<span style='color:#808030; '>.</span>RouteData<span style='color:#808030; '>.</span>Values<span style='color:#808030; '>[</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>name</span><span style='color:#800000; '>"</span><span style='color:#808030; '>]</span> <span style='color:#800000; font-weight:bold; '>as</span> <span style='color:#800000; font-weight:bold; '>string</span><span style='color:#800080; '>;</span>
        <span style='color:#800000; font-weight:bold; '>return</span> display<span style='color:#800080; '>;</span>
    <span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span>
</pre>
<p>CreateInstancefromvirtualpath method processes a file, given its virtual path, and creates an instance of the result. Code for generating the automatically generated urls</p>
<pre>
RouteValueDictionary parameters <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> RouteValueDictionary <span style='color:#800080; '>{</span> <span style='color:#800080; '>{</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>name</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>India</span><span style='color:#800000; '>"</span> <span style='color:#800080; '>}</span><span style='color:#800080; '>}</span><span style='color:#800080; '>;</span>
</pre>
<p>This code creates an instance of the RouteValueDictionary class that contains three parameters.</p>
<pre>
VirtualPathData vpd <span style='color:#808030; '>=</span> RouteTable<span style='color:#808030; '>.</span>Routes<span style='color:#808030; '>.</span>GetVirtualPath<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>null</span><span style='color:#808030; '>,</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>ExpensesRoute</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> parameters<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
</pre>
<p>Virtual Path Data represents information about the route and virtual path that are the result of generating a URL with the ASP.NET routing framework. This code instantiates a VirtualPathData object by calling the GetVirtualPath method of the RouteCollection class.</p>
<pre>
HyperLink6<span style='color:#808030; '>.</span>NavigateUrl <span style='color:#808030; '>=</span> vpd<span style='color:#808030; '>.</span>VirtualPath<span style='color:#800080; '>;</span>
</pre>

<p>
    <b>ASP.NET URL Rewriting Vs Routing</b>
    <br />
    ASP.NET routing differs from URL rewriting. URL rewriting processes incoming requests by actually changing the URL before it sends the request to the Web page. For example, an application that uses URL rewriting might change a URL from /Products/Widgets/ to /Products.aspx?id=4. Also, URL rewriting typically does not have an API for creating URLs that are based on your patterns. In URL rewriting, if you change a URL pattern, you must manually update all hyperlinks that contain the original URL. With ASP.NET routing, the URL is not changed when an incoming request is handled, because routing can extract values from the URL. When you have to create a URL, you pass parameter values into a method that generates the URL for you. To change the URL pattern, you change it in one location, and all the links that you create in the application that are based on that pattern will automatically use the new pattern.
</p>
<br />
<a href="https://github.com/guntidheerajkumar/ExampleRouting" class="btn btn-danger"> Sample</a>
